# OpenCode 常见失败 FAQ

本 FAQ 聚焦高频失败场景，按“现象 -> 排查 -> 最小修复”给出处理顺序。

---

## 1. `/opsx-apply` 后任务未推进

现象：

- 变更已 apply，但执行状态无进展

排查：

1. 确认是否误并行执行了 `/start-work`
2. 检查 `tasks.md` 是否缺失任务 ID/验收标准
3. 检查是否存在两套冲突计划文档

处理：

- 统一为单套计划，补全 `tasks.md` 后重试执行

---

## 2. `/opsx-verify <CHANGE_ID>` 失败

现象：

- 一致性校验返回失败

排查：

1. 检查目录结构与必备产物是否齐全
2. 检查 `proposal.md`、`tasks.md`、`specs/` 格式
3. 检查 `<CHANGE_ID>` 与目录命名一致性

处理：

- 只修复导致校验失败的最小问题，不做无关改动，修复后立即复验

---

## 3. 回归测试失败但规范看起来正确

现象：

- 文档完整，但测试不通过

排查：

1. 先复现失败用例并固定触发条件
2. 确认失败是否由本次改动引入
3. 划定影响范围，避免扩大修复面

处理：

- 仅修复失败项，执行必要回归，更新 `verification-report.md`

---

## 4. 归档被拒绝或不建议归档

现象：

- `/opsx-archive <CHANGE_ID>` 未通过，或评估结论为不可归档

排查：

1. 是否仍有阻断级未完成项
2. 证据路径是否缺失
3. 风险是否未说明或不可接受

处理：

- 先补证据与风险结论，收敛阻断项后再归档

---

## 5. 大任务计划反复变更导致执行混乱

现象：

- `.sisyphus/plans/` 与 OpenSpec 中计划不一致

排查：

1. 是否保留了多套 Plan 文档
2. 任务 ID、依赖顺序、验收标准是否被改写

处理：

- 仅保留最新单套 Plan v1，同步落盘到 `proposal/specs/tasks`，禁止并行计划

---

## 6. 提示词跑偏，输出不符合预期

现象：

- 产物缺字段、范围扩大、执行顺序混乱

排查：

1. 是否缺少明确约束（最小改动、禁止重构）
2. 是否缺少输出格式要求
3. 是否缺少验收与风险说明要求

处理：

- 按统一模板重写提示词：目标、输入、约束、输出、验收

---

## 7. 快速自检命令

```bash
openspec list --json
openspec status --change <CHANGE_ID> --json
```

```text
/opsx-verify <CHANGE_ID>
```
